{"version":3,"file":"./functions/graphql/handler.js","mappings":"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EAChD,IAAMnD,KAAK,GAAG6C,cAAc,CAACM,GAAG,CAAC;EACjC,IAAI,CAACnD,KAAK,EAAE;EACZ,OAAOsC,SAAS,CAACtC,KAAK,CAAC;AACzB,CAAC;;;;;;;;;;;;;;AC9BD,iEAAe,gBAAgB,oGAAoG,GAAG;;;;;;;;;;;;;;ACAtI,iEAAe,aAAa,6BAA6B,YAAY,sGAAsG,GAAG;;;;;;;;;;ACA9K;;;;;;;;;;ACAA;;;;;;UCAA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;;;;WClCA;WACA;WACA;WACA;WACA,+BAA+B,wCAAwC;WACvE;WACA;WACA;WACA;WACA,iBAAiB,qBAAqB;WACtC;WACA;WACA,kBAAkB,qBAAqB;WACvC;WACA;WACA,KAAK;WACL;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;;;;;WC3BA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,EAAE;WACF;;;;;WCRA;WACA;WACA;WACA;WACA;;;;;WCJA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;WCNA;;WAEA;WACA;WACA;WACA;WACA;;WAEA;;WAEA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,gBAAgB,qBAAqB;WACrC;WACA;WACA;;WAEA;WACA;WACA;WACA;WACA,aAAa;WACb;WACA,IAAI;WACJ;WACA;;WAEA;;WAEA;;WAEA;;;;;WCrCA;WACA;WACA;WACA;WACA;;;;;UEJA;UACA","sources":["webpack://bizzi-food-ordering/./functions/graphql/handler.ts","webpack://bizzi-food-ordering/./functions/graphql/resolvers/index.ts","webpack://bizzi-food-ordering/./functions/graphql/resolvers/register.ts","webpack://bizzi-food-ordering/./functions/graphql/typeDefs/index.ts","webpack://bizzi-food-ordering/./keys/privateKey.ts","webpack://bizzi-food-ordering/./keys/publicKey.ts","webpack://bizzi-food-ordering/./services/account/register.ts","webpack://bizzi-food-ordering/./services/query.ts","webpack://bizzi-food-ordering/./utils/common.ts","webpack://bizzi-food-ordering/./utils/config.ts","webpack://bizzi-food-ordering/./utils/email.ts","webpack://bizzi-food-ordering/./utils/errors.ts","webpack://bizzi-food-ordering/./utils/jwt.ts","webpack://bizzi-food-ordering/./functions/graphql/typeDefs/register.graphql","webpack://bizzi-food-ordering/./functions/graphql/typeDefs/root.graphql","webpack://bizzi-food-ordering/external node-commonjs \"os\"","webpack://bizzi-food-ordering/external var \"apollo-server-lambda\"","webpack://bizzi-food-ordering/webpack/bootstrap","webpack://bizzi-food-ordering/webpack/runtime/chunk loaded","webpack://bizzi-food-ordering/webpack/runtime/compat get default export","webpack://bizzi-food-ordering/webpack/runtime/define property getters","webpack://bizzi-food-ordering/webpack/runtime/ensure chunk","webpack://bizzi-food-ordering/webpack/runtime/get javascript chunk filename","webpack://bizzi-food-ordering/webpack/runtime/hasOwnProperty shorthand","webpack://bizzi-food-ordering/webpack/runtime/make namespace object","webpack://bizzi-food-ordering/webpack/runtime/require chunk loading","webpack://bizzi-food-ordering/webpack/runtime/startup chunk dependencies","webpack://bizzi-food-ordering/webpack/before-startup","webpack://bizzi-food-ordering/webpack/startup","webpack://bizzi-food-ordering/webpack/after-startup"],"sourcesContent":["import { ApolloServer } from 'apollo-server-lambda'\n\nimport resolvers from './resolvers'\nimport typeDefs from './typeDefs'\n\n// import createCompanyBankAccount from \"services/createCompanyBankAccount\";\n\n// interface PluginDefinition {\n//   serverWillStart(): Promise<void>;\n// }\n\nconst server = new ApolloServer({\n  typeDefs,\n  resolvers,\n  introspection: true\n  // formatError: err => {\n  //   throw new Error(\"Internal server error\");\n  // },\n  // context: authenticationMiddleware,\n  // plugins: [ApolloLogPlugin() as PluginDefinition, initI18nPlugin],\n})\n\nexport const graphql = server.createHandler()\n","import { mergeResolvers } from '@graphql-tools/merge'\nimport register from './register'\n// import generateOTP from './generateOTP'\n// import verifyOTP from './verifyOTP'\n// import login from './login'\n\nexport default {\n  ...mergeResolvers([register])\n}\n","import register, { RegisterInput } from 'services/account/register'\n\nconst resolver = {\n  Mutation: {\n    register: (_parent: any, args: RegisterInput): Promise<boolean> => {\n      return register(args)\n    }\n  }\n}\n\nexport default resolver\n","import { mergeTypeDefs } from '@graphql-tools/merge'\nimport root from './root.graphql'\nimport register from './register.graphql'\n// import generateOTP from './generateOTP.graphql'\n// import verifyOTP from './verifyOTP.graphql'\n// import login from './login.graphql'\n\nexport default mergeTypeDefs([root, register])\n","export default `-----BEGIN RSA PRIVATE KEY-----\n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\n-----END RSA PRIVATE KEY-----\n`\n","export default `-----BEGIN PUBLIC KEY-----\nMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAwDRMRw1iAaK9R6yFJz+Z\nqVRCxVpjYO7PLMlF/6KV9jVNu0RwI2LksXni7JsqsMoM9pVTLNatrr5Ea6e2sTqL\n1NCWYjU2X8o2C12UrouCb1z7fsEgvrLhhXUmCUbLRn1/ogNBFfLzhHRiYclSK0Vg\nnheAgeA0jg+NFze1OJ+W9PYo36WxLi/KaGvJ3qoaig2PhPZXUImFKcBN1nnP94V2\nFA6u15Qleo1Z2nkUjPppMaqnwlAWsLJnwjGv4KIHiCFm2VI6kR86dKc9IgABsRBt\nJ/8hPEfHZboJLPfNwvgpxwYvvorEsaZMpgwXwUw+QZkPkIGrJdKZrBDagKLGtuu6\nwBZGjIGx4lweq5B4cxiKaUKoXibBY7+Md57R8v8S2dDvofYrTPRgXHQt/sOR1shP\nZC+c96zbLgnvVe8e5FcldsTC2TW7CNMHHQvlNBhQjOfiuQRduxA8CnruUCDvbE1d\nQRYzT9Yf/8j8eJFlnI4LKK8Eyhr3MwnKPP0hl86pv/NECr72yXbhov6paT3QjkzB\nN9Xmio/6zF15zAKPuQTMORWKODNyAA+13jcTzzjfns1ksjkk+SdUT/eRF4GM2RS/\nr1rdARqMdM4uK1DNKcl3jt77lkkRTQocQHDWAlmz+45aROFM8GJtt0xCCiQGW0aR\nI+g2MODug5+ZufCx3jgZw9UCAwEAAQ==\n-----END PUBLIC KEY-----\n`\n","import bcrypt from 'bcrypt'\nimport OTP from 'otp'\nimport { query } from '../query'\nimport { SERVER_ERROR_CODE } from 'utils/errors'\nimport { verifyEmail, logger } from 'utils/common'\nimport sendMail from 'utils/email'\n\nexport type RegisterInput = {\n  email: string\n  password: string\n  displayedName: string\n  avatar?: string\n}\n\nconst checkExistUser = async (email: string) => {\n  const QUERY_USER_BY_EMAIL = /* GraphQL */ `\n    query userByEmail($email: String!) {\n      users: users(where: { email: { _eq: $email } }) {\n        user_id\n      }\n    }\n  `\n  const {\n    data: { users }\n  } = await query<\n    {\n      data: { users: Partial<Users>[] }\n    },\n    { email: string }\n  >(QUERY_USER_BY_EMAIL, {\n    email\n  })\n  if (users.length) throw new Error(SERVER_ERROR_CODE.EMAIL_EXISTED)\n}\n\nconst insertUser = async (object: Partial<Users>) => {\n  const INSERT_USER = /* GraphQL */ `\n    mutation insertUser($object: users_insert_input!) {\n      user: insert_users_one(object: $object) {\n        email\n      }\n    }\n  `\n  const {\n    data: { user }\n  } = await query<\n    {\n      data: { user: Partial<Users> }\n    },\n    { object: Partial<Users> }\n  >(INSERT_USER, {\n    object\n  })\n  if (!user.email) throw new Error(SERVER_ERROR_CODE.INTERNAL_SERVER_ERROR)\n}\n\nconst handler = async ({ email, password, displayedName, avatar }: RegisterInput) => {\n  try {\n    {\n      // validate payload\n      verifyEmail(email)\n      // verifyImage(avatar)\n      if (password.length < 6) throw new Error(SERVER_ERROR_CODE.PASSWORD_TOO_SHORT)\n    }\n    await checkExistUser(email)\n\n    const accessSecretKey = Math.random().toString(36).slice(2)\n    await insertUser({\n      email,\n      password_hashed: await bcrypt.hash(password, 10),\n      access_secret_key: accessSecretKey,\n      displayed_name: displayedName,\n      changed_displayed_name_manually: !!displayedName,\n      avatar,\n      changed_avatar_manually: !!avatar,\n      active: false\n    })\n    const otpInstance = new OTP({\n      secret: accessSecretKey\n    })\n    const otp = otpInstance.totp(new Date().getTime())\n    sendMail({\n      receivers: [email],\n      subject: 'Verify email',\n      text: `Here your otp: ${otp}. This otp lives in 30s`\n    })\n    return true\n  } catch (error) {\n    logger.error(error)\n    return false\n  }\n}\n\nexport default handler\n","import got, { Response } from 'got'\nimport { ENV } from 'utils/config'\nimport { signJWT } from 'utils/jwt'\n\nconst request = got.extend({\n  responseType: 'json'\n})\n\nconst token = null\n\nconst requestServiceToken = async (): Promise<string> => {\n  if (!!token) return token\n  return signJWT({\n    'admin': true,\n    'https://hasura.io/jwt/claims': {\n      'x-hasura-allowed-roles': ['admin'],\n      'x-hasura-default-role': 'admin',\n      'x-hasura-service-id': ENV.SERVICE_ID\n    }\n  })\n}\n\nexport const query = async <T, K = undefined>(query: string, variables?: K): Promise<T> => {\n  const token = await requestServiceToken()\n  const resp: Response<T> = await request.post<T>(`${ENV.HASURA_ENDPOINT}/v1/graphql`, {\n    json: {\n      query,\n      variables\n    },\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${token}`\n    }\n  })\n  return resp.body\n}\n","import pino from 'pino'\nimport { SERVER_ERROR_CODE } from 'utils/errors'\n\nexport const verifyEmail = (email: string) => {\n  if (!/@bizzi.vn\\s*$/.test(email)) {\n    throw new Error(SERVER_ERROR_CODE.INVALID_INPUT)\n  }\n}\n\nexport const verifyImage = (url: string) => {\n  if (\n    !(\n      url.startsWith('https://') &&\n      (url.endsWith('png') || url.endsWith('jpg') || url.endsWith('jpeg'))\n    )\n  ) {\n    throw new Error(SERVER_ERROR_CODE.INVALID_INPUT)\n  }\n}\n\nexport const logger = pino()\n","export const ENV = {\n  HASURA_ENDPOINT: process.env['HASURA_ENDPOINT'],\n  SERVICE_ID: process.env['SERVICE_ID'],\n  SERVICE_SECRET: process.env['SERVICE_SECRET'],\n  GOOGLE_AUTH_CLIENT_ID: process.env['GOOGLE_AUTH_CLIENT_ID'],\n  GOOGLE_AUTH_SECRET: process.env['GOOGLE_AUTH_SECRET'],\n  EMAIL_USER: process.env['EMAIL_USER'],\n  EMAIL_PASSWORD: process.env['EMAIL_PASSWORD']\n}\n","import nodemailer from 'nodemailer'\nimport { ENV } from 'utils/config'\n\ntype SendMail = {\n  receivers: string[]\n  subject: string\n  text: string\n}\n\nconst sendMail = async ({ receivers, subject, text }: SendMail) => {\n  const transporter = nodemailer.createTransport({\n    host: 'smtp.gmail.com',\n    port: 465,\n    secure: false, // true for 465, false for other ports\n    auth: {\n      user: ENV.EMAIL_USER,\n      pass: ENV.EMAIL_PASSWORD\n    }\n  })\n  await transporter.sendMail({\n    from: 'Bizzi Food Ordering',\n    to: receivers.join(','),\n    subject,\n    text\n  })\n}\n\nexport default sendMail\n","export enum SERVER_ERROR_CODE {\n  INTERNAL_SERVER_ERROR = 'INTERNAL_SERVER_ERROR',\n  EMAIL_EXISTED = 'EMAIL_EXISTED',\n  CANNOT_FIND_USER = 'CANNOT_FIND_USER',\n  CANNOT_FIND_GROUP = 'CANNOT_FIND_GROUP',\n  UNAUTHORIZED = 'UNAUTHORIZED',\n  INVALID_INPUT = 'INVALID_INPUT',\n  INVALID_OTP = 'INVALID_OTP',\n  PASSWORD_TOO_SHORT = 'PASSWORD_TOO_SHORT',\n  PASSWORD_NOT_MATCH = 'PASSWORD_NOT_MATCH'\n}\n","import jwt from 'jsonwebtoken'\nimport publicKeyRS256 from 'keys/publicKey'\nimport privateKeyRS256 from 'keys/privateKey'\n\nexport const verifyJWT = (\n  token: string,\n  publicKey = publicKeyRS256,\n  algorithms = ['RS256'] as jwt.Algorithm[]\n) =>\n  jwt.verify(token, publicKey, {\n    algorithms\n  })\n\nexport const signJWT = (payload: Record<string, any>, privateKey = privateKeyRS256) =>\n  jwt.sign(payload, privateKey)\n\nexport const getBearerToken = ({ headers }: any) => {\n  const Authorization: string = headers.Authorization || headers.authorization\n  const XAuthorization: string = headers['X-Authorization'] || headers['x-authorization']\n\n  if (!Authorization && !XAuthorization) {\n    throw new Error('No authorization')\n  }\n  return (Authorization || XAuthorization).split('Bearer ')[1]\n}\n\nexport const verifyJWTFromRequest = (req: any) => {\n  const token = getBearerToken(req)\n  if (!token) return\n  return verifyJWT(token) as jwt.JwtPayload\n}\n","export default \"type Mutation {\\n  register(email: String!, password: String!, displayedName: String!, avatar: String): Boolean!\\n}\\n\";","export default \"type Query {\\n  _empty_billing: String\\n}\\n\\nschema {\\n  query: Query\\n  # uncomment this line if this service have some mutations\\n  mutation: Mutation\\n}\\n\";","module.exports = require(\"os\");","module.exports = apollo-server-lambda;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n__webpack_require__.x = () => {\n\t// Load entry module and return exports\n\t// This entry module depends on other loaded chunks and execution need to be delayed\n\tvar __webpack_exports__ = __webpack_require__.O(undefined, [\"vendors-node_modules_jsonwebtoken_index_js-node_modules_nodemailer_lib_nodemailer_js-node_mod-520291\"], () => (__webpack_require__(\"./functions/graphql/handler.ts\")))\n\t__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n\treturn __webpack_exports__;\n};\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".js\";\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// no baseURI\n\n// object to store loaded chunks\n// \"1\" means \"loaded\", otherwise not loaded yet\nvar installedChunks = {\n\t\"./functions/graphql/handler\": 1\n};\n\n__webpack_require__.O.require = (chunkId) => (installedChunks[chunkId]);\n\nvar installChunk = (chunk) => {\n\tvar moreModules = chunk.modules, chunkIds = chunk.ids, runtime = chunk.runtime;\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\tfor(var i = 0; i < chunkIds.length; i++)\n\t\tinstalledChunks[chunkIds[i]] = 1;\n\t__webpack_require__.O();\n};\n\n// require() chunk loading for javascript\n__webpack_require__.f.require = (chunkId, promises) => {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\tinstallChunk(require(\"../../\" + __webpack_require__.u(chunkId)));\n\t\t} else installedChunks[chunkId] = 1;\n\t}\n};\n\n// no external install chunk\n\n// no HMR\n\n// no HMR manifest","var next = __webpack_require__.x;\n__webpack_require__.x = () => {\n\t__webpack_require__.e(\"vendors-node_modules_jsonwebtoken_index_js-node_modules_nodemailer_lib_nodemailer_js-node_mod-520291\");\n\treturn next();\n};","","// run startup\nvar __webpack_exports__ = __webpack_require__.x();\n",""],"names":["ApolloServer","resolvers","typeDefs","server","introspection","graphql","createHandler","mergeResolvers","register","resolver","Mutation","_parent","args","mergeTypeDefs","root","bcrypt","OTP","query","SERVER_ERROR_CODE","verifyEmail","logger","sendMail","checkExistUser","email","QUERY_USER_BY_EMAIL","users","data","length","Error","EMAIL_EXISTED","insertUser","object","INSERT_USER","user","INTERNAL_SERVER_ERROR","handler","password","displayedName","avatar","PASSWORD_TOO_SHORT","accessSecretKey","Math","random","toString","slice","hash","password_hashed","access_secret_key","displayed_name","changed_displayed_name_manually","changed_avatar_manually","active","otpInstance","secret","otp","totp","Date","getTime","receivers","subject","text","error","got","ENV","signJWT","request","extend","responseType","token","requestServiceToken","SERVICE_ID","variables","post","HASURA_ENDPOINT","json","headers","resp","body","pino","test","INVALID_INPUT","verifyImage","url","startsWith","endsWith","process","env","SERVICE_SECRET","GOOGLE_AUTH_CLIENT_ID","GOOGLE_AUTH_SECRET","EMAIL_USER","EMAIL_PASSWORD","nodemailer","transporter","createTransport","host","port","secure","auth","pass","from","to","join","jwt","publicKeyRS256","privateKeyRS256","verifyJWT","publicKey","algorithms","verify","payload","privateKey","sign","getBearerToken","Authorization","authorization","XAuthorization","split","verifyJWTFromRequest","req"],"sourceRoot":""}